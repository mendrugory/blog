---
title: "Where is my Airport?"
date: 2014-10-26
url: /post/where-is-my-airport
index: true
---

<div class="blog-content">
 <div class="paragraph" style="text-align:left;">
 <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
  <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
   <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
    <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
     <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
      <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
       <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
        <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
         <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
          <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
           <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
            <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
             <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
              <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
               <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
                <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
                 <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
                  <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
                   <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
                    <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
                     <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
                      <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
                       <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
                        <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
                         <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
                          <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
                           <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
                             I have to say that I love maps and for a long time I have wanted to check out the complementary tools:
                            <a href="http://leafletjs.com/" target="_blank" title="">
                              Leaflet
                            </a>
                             maps and NoSQL geo-function.
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span style="">
           <span style="">
            <span style="">
             <span style="">
              <span style="">
               <span style="">
                <span style="">
                 <span style="">
                  <span style="">
                   <span style="">
                    <span style="">
                     <span style="">
                      <span style="">
                       <span style="">
                        <span style="">
                         <span style="">
                          <span style="">
                           <span style="">
                             Hence, I decided to build a location app which will help people to find their closest airports.
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span style="">
           <span style="">
            <span style="">
             <span style="">
              <span style="">
               <span style="">
                <span style="">
                 <span style="">
                  <span style="">
                   <span style="">
                    <span style="">
                     <span style="">
                      <span style="">
                       <span style="">
                        <span style="">
                         <span style="">
                          <span style="">
                           <span style="">
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span style="">
           <span style="">
            <span style="">
             <span style="">
              <span style="">
               <span style="">
                <span style="">
                 <span style="">
                  <span style="">
                   <span style="">
                    <span style="">
                     <span style="">
                      <span style="">
                       <span style="">
                        <span style="">
                         <span style="">
                          <span style="">
                           <span style="">
                            <span style="">
                             <span style="">
                              <span style="">
                               <span style="">
                                <span style="">
                                 <span style="">
                                  <span style="">
                                   <span style="">
                                    <span style="">
                                     <span style="">
                                      <span style="">
                                       <span style="">
                                        <span style="">
                                         <span style="">
                                          <span style="">
                                           <span style="">
                                            <span style="">
                                             <span style="">
                                              <span style="">
                                               <span style="">
                                                <span style="">
                                                 <span style="">
                                                  <span style="">
                                                   <span style="">
                                                    <span style="">
                                                     <span style="">
                                                       I evaluated
                                                      <a href="http://docs.arangodb.org/SimpleQueries/GeoQueries.html" style="" target="_blank" title="">
                                                        ArangoDB
                                                      </a>
                                                       and
                                                     </span>
                                                    </span>
                                                   </span>
                                                  </span>
                                                 </span>
                                                </span>
                                               </span>
                                              </span>
                                             </span>
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                            <span style="">
                             <span style="">
                              <span style="">
                               <span style="">
                                <span style="">
                                 <span style="">
                                  <span style="">
                                   <span style="">
                                    <span style="">
                                     <span style="">
                                      <span style="">
                                       <span style="">
                                        <span style="">
                                         <span style="">
                                          <span style="">
                                           <span style="">
                                            <span style="">
                                             <span style="">
                                              <span style="">
                                               <span style="">
                                                <span style="">
                                                 <span style="">
                                                  <span style="">
                                                   <span style="">
                                                    <span style="">
                                                     <span style="">
                                                      <span style="">
                                                       <span style="">
                                                        <span style="">
                                                         <span style="">
                                                          <span style="">
                                                           <span style="">
                                                            <span style="">
                                                             <span style="">
                                                              <span style="">
                                                               <span style="">
                                                                <span style="">
                                                                 <span style="">
                                                                  <span style="">
                                                                   <span style="">
                                                                    <span style="">
                                                                     <span style="">
                                                                      <span style="">
                                                                       <span style="">
                                                                        <a href="http://docs.mongodb.org/manual/applications/geospatial-indexes/" style="" target="_blank" title="">
                                                                          MongoDB
                                                                        </a>
                                                                         as NoSQL data bases.
                                                                       </span>
                                                                      </span>
                                                                     </span>
                                                                    </span>
                                                                   </span>
                                                                  </span>
                                                                 </span>
                                                                </span>
                                                               </span>
                                                              </span>
                                                             </span>
                                                            </span>
                                                           </span>
                                                          </span>
                                                         </span>
                                                        </span>
                                                       </span>
                                                      </span>
                                                       ArangoDB worked very good but the python driver was not as good as I expected therefore MongoDB was the selected data base
                                                     </span>
                                                    </span>
                                                   </span>
                                                  </span>
                                                 </span>
                                                </span>
                                               </span>
                                              </span>
                                               .
                                             </span>
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                            <br>
                             <br>
                               After finishing the app,
                             </br>
                            </br>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <span style="">
      <span style="">
       <span style="">
        <span style="">
         <span style="">
          <span style="">
           <span style="">
            <span style="">
             <span style="">
              <span style="">
               <span style="">
                <span style="">
                 <span style="">
                  <span style="">
                   <span style="">
                    <span style="">
                     <span style="">
                      <span style="">
                       <span style="">
                        <span style="">
                         <span style="">
                          <span style="">
                           <span style="">
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <span style="">
      <span style="">
       <span style="">
        <span style="">
         <span style="">
          <span style="">
           <span style="">
             if I try to execute the app it will return the 10-closest airports to me:
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </span>
   </span>
  </span>
 </span>
 </div>
 <div>
 <div class="wsite-image wsite-image-border-thin" style="padding-top:10px;padding-bottom:10px;margin-left:0;margin-right:0;text-align:center">
  <a>
   <img alt="Imagen" src="/img/4356943_orig.png" style="width:100%;max-width:1100px"/>
  </a>
  <div style="display:block;font-size:90%">
  </div>
 </div>
 </div>
 <h2 class="wsite-content-title" style="text-align:left;">
 <span style="text-decoration:none; font-style:normal; font-weight:700; color:rgb(73, 68, 66);">
   Backend
  <br/>
 </span>
 </h2>
 <div class="paragraph" style="text-align:left;">
 <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
  <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
   <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
    <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
     <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
      <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
       <span style="">
        <span style="">
         <span style="">
          <span style="">
           <span style="">
            <span style="">
             <span style="">
              <span style="">
               <span style="">
                <span style="">
                 <span style="">
                  <span style="">
                   <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
                    <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
                     <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
                      <span style="">
                       <span style="">
                        <span style="">
                         <span style="">
                          <span style="">
                           <span style="">
                            <span style="">
                             <span style="">
                              <span style="">
                               <span style="">
                                <span style="">
                                 <span style="">
                                  <span style="">
                                   <span style="">
                                    <span style="">
                                     <span style="">
                                      <span style="">
                                       <span style="">
                                         The first task was finding all the data related to the airports. It was very easy thanks to
                                        <a href="http://openflights.org/" style="" target="_blank" title="">
                                          Openflights
                                        </a>
                                         which have a lot of information about flights, airports and so on.
                                        <br>
                                         <br/>
                                        </br>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                    After having the data, I needed to re-format it in order to be imported byÂ  MongoDB. The most important part was to transform the given latitude and longitude to a
                   <a href="http://geojson.org/geojson-spec.html#id2" style="" target="_blank" title="">
                     GeoJson Point format
                   </a>
                    .
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </span>
   </span>
  </span>
 </span>
 </div>
 <div>
 <div align="left" class="wcustomhtml" id="783839609105069226" style="width: 100%; overflow-y: hidden;">
  <!-- code formatted by http://manoli.net/csharpformat/ -->
  <style type="text/css">
    .csharpcode, .csharpcode pre {         font-size: small;         color: black;         font-family: Consolas, "Courier New", Courier, Monospace;         background-color: #ffffff;         /*white-space: pre;*/ }  .csharpcode pre { margin: 0em; }  .csharpcode .rem { color: #008000; }  .csharpcode .kwrd { color: #0000ff; }  .csharpcode .str { color: #a31515; }  .csharpcode .op { color: #0000c0; }  .csharpcode .preproc { color: #cc6633; }  .csharpcode .asp { background-color: #ffff00; }  .csharpcode .html { color: #800000; }  .csharpcode .attr { color: #ff0000; }  .csharpcode .alt  {         background-color: #f4f4f4;         width: 100%;         margin: 0em; }  .csharpcode .lnum { color: #606060; }
  </style>
  <div class="csharpcode">
   <pre class="alt"> <span class="lnum">   1: </span>{ <span class="str">"type"</span>: <span class="str">"Point"</span>, <span class="str">"coordinates"</span>: [100.0, 0.0] } </pre>
  </div>
 </div>
 </div>
 <div class="paragraph" style="text-align:left;">
 <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
  <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
   <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
    <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
     <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
      <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
       <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
        <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
         <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
          <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
           <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
            <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
             <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
              <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
               <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
                <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
                 <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
                  <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
                   <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
                    <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
                      The
                     <em>
                       "coordinates"
                     </em>
                      field has to contain the longitude first and the latitude after.
                     <br>
                      <br>
                        MongoDB geo-function
                      </br>
                     </br>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <em>
                 <span style="">
                  <span style="">
                   <span style="">
                    <span style="">
                     <span style="">
                       $near
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </em>
                <span style="">
                 <span style="">
                  <span style="">
                   <span style="">
                    <span style="">
                      returns the a sorted list of the closest locations (stored documents) to a given location. But, to take advantage of this functionality a geo-index is needed:
                     <br/>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </span>
   </span>
  </span>
 </span>
 </div>
 <div>
 <div align="left" class="wcustomhtml" id="739454019788407507" style="width: 100%; overflow-y: hidden;">
  <!-- code formatted by http://manoli.net/csharpformat/ -->
  <style type="text/css">
    .csharpcode, .csharpcode pre {         font-size: small;         color: black;         font-family: Consolas, "Courier New", Courier, Monospace;         background-color: #ffffff;         /*white-space: pre;*/ }  .csharpcode pre { margin: 0em; }  .csharpcode .rem { color: #008000; }  .csharpcode .kwrd { color: #0000ff; }  .csharpcode .str { color: #a31515; }  .csharpcode .op { color: #0000c0; }  .csharpcode .preproc { color: #cc6633; }  .csharpcode .asp { background-color: #ffff00; }  .csharpcode .html { color: #800000; }  .csharpcode .attr { color: #ff0000; }  .csharpcode .alt  {         background-color: #f4f4f4;         width: 100%;         margin: 0em; }  .csharpcode .lnum { color: #606060; }
  </style>
  <div class="csharpcode">
   <pre class="alt"> <span class="lnum">   1: </span>db.collection_name.ensureIndex({<span class="str">"loc"</span>:<span class="str">"2dsphere"</span>}) </pre>
  </div>
 </div>
 </div>
 <div class="paragraph" style="text-align:left;">
 <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
  <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
   <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
    <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
     <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
      <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
       <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
        <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
         <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
          <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
           <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
            <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
             <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
              <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
               <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
                 Once that we have all our data ready, we use
                <a href="http://flask.pocoo.org/" target="_blank" title="">
                  Flask
                </a>
                 as backend technology and
                <a href="http://mongoengine.org/" target="_blank" title="">
                  MongoEngine
                </a>
                 as
               </span>
              </span>
             </span>
            </span>
           </span>
           <span style="">
            <span style="">
             <span style="">
              <span style="">
               <span style="">
               </span>
              </span>
             </span>
            </span>
           </span>
           <span style="">
             Object-Document Mapper
           </span>
           <span style="">
            <span style="">
             <span style="">
              <span style="">
               <span style="">
               </span>
              </span>
             </span>
            </span>
           </span>
            . I tried to use the near function which is implemented inside MongoEngine, but I could not, hence I took the raw-query functionality.
           <br>
            <br>
              models.py :
             <br/>
            </br>
           </br>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </span>
   </span>
  </span>
 </span>
 </div>
 <div>
 <div align="left" class="wcustomhtml" id="694095089553840486" style="width: 100%; overflow-y: hidden;">
  <!-- code formatted by http://manoli.net/csharpformat/ -->
  <style type="text/css">
    .csharpcode, .csharpcode pre {         font-size: small;         color: black;         font-family: Consolas, "Courier New", Courier, Monospace;         background-color: #ffffff;         /*white-space: pre;*/ }  .csharpcode pre { margin: 0em; }  .csharpcode .rem { color: #008000; }  .csharpcode .kwrd { color: #0000ff; }  .csharpcode .str { color: #a31515; }  .csharpcode .op { color: #0000c0; }  .csharpcode .preproc { color: #cc6633; }  .csharpcode .asp { background-color: #ffff00; }  .csharpcode .html { color: #800000; }  .csharpcode .attr { color: #ff0000; }  .csharpcode .alt  {         background-color: #f4f4f4;         width: 100%;         margin: 0em; }  .csharpcode .lnum { color: #606060; }
  </style>
  <div class="csharpcode">
   <pre class="alt"> <span class="lnum">   1: </span><span class="kwrd">from</span> settings import db </pre>
   <pre> <span class="lnum">   2: </span> </pre>
   <pre class="alt"> <span class="lnum">   3: </span> </pre>
   <pre> <span class="lnum">   4: </span><span class="kwrd">class</span> Airport(db.Document): </pre>
   <pre class="alt"> <span class="lnum">   5: </span>    city = db.StringField() </pre>
   <pre> <span class="lnum">   6: </span>    name = db.StringField() </pre>
   <pre class="alt"> <span class="lnum">   7: </span>    country = db.StringField() </pre>
   <pre> <span class="lnum">   8: </span>    iata_faa = db.StringField(<span class="kwrd">default</span>=None) </pre>
   <pre class="alt"> <span class="lnum">   9: </span>    tz = db.StringField(<span class="kwrd">default</span>=None) </pre>
   <pre> <span class="lnum">  10: </span>    icao = db.StringField(<span class="kwrd">default</span>=None) </pre>
   <pre class="alt"> <span class="lnum">  11: </span>    dst = db.StringField(<span class="kwrd">default</span>=None) </pre>
   <pre> <span class="lnum">  12: </span>    loc = db.PointField(<span class="kwrd">default</span>=None) </pre>
   <pre class="alt"> <span class="lnum">  13: </span> </pre>
   <pre> <span class="lnum">  14: </span>    @staticmethod </pre>
   <pre class="alt"> <span class="lnum">  15: </span>    def get_closest_airports(lonlat, limit=10): </pre>
   <pre> <span class="lnum">  16: </span>       <span class="str">""</span><span class="str">"</span> </pre>
   <pre class="alt"> <span class="str"><span class="lnum">  17: </span>        Using a raw query it returns the "</span>limit<span class="str">" closest airports.</span> </pre>
   <pre> <span class="str"><span class="lnum">  18: </span> </span> </pre>
   <pre class="alt"> <span class="lnum">  19: </span>        :param latlon list: </pre>
   <pre> <span class="lnum">  20: </span>        :return list of airports: </pre>
   <pre class="alt"> <span class="lnum">  21: </span>        "<span class="str">""</span> </pre>
   <pre> <span class="lnum">  22: </span>       <span class="kwrd">return</span> Airport.objects( </pre>
   <pre class="alt"> <span class="lnum">  23: </span>            __raw__={<span class="str">"loc"</span>: {<span class="str">"$near"</span>: {<span class="str">"$geometry"</span>: {<span class="str">"type"</span>: <span class="str">"Point"</span>, <span class="str">"coordinates"</span>: lonlat}}}}).limit(limit) </pre>
   <pre> <span class="lnum">  24: </span> </pre>
   <pre class="alt"> <span class="lnum">  25: </span>    def __dict__(self): </pre>
   <pre> <span class="lnum">  26: </span>       <span class="kwrd">return</span> { </pre>
   <pre class="alt"> <span class="lnum">  27: </span>           <span class="str">"city"</span>: self.city, </pre>
   <pre> <span class="lnum">  28: </span>           <span class="str">"name"</span>: self.name, </pre>
   <pre class="alt"> <span class="lnum">  29: </span>           <span class="str">"country"</span>: self.country, </pre>
   <pre> <span class="lnum">  30: </span>           <span class="str">"lat"</span>: self.loc[<span class="str">"coordinates"</span>].pop(), </pre>
   <pre class="alt"> <span class="lnum">  31: </span>           <span class="str">"lon"</span>: self.loc[<span class="str">"coordinates"</span>].pop() </pre>
   <pre> <span class="lnum">  32: </span>        } </pre>
  </div>
 </div>
 </div>
 <div class="paragraph" style="text-align:left;">
 <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
  <br/>
 </span>
 </div>
 <h2 class="wsite-content-title" style="text-align:left;">
 <span style="text-decoration:none; font-style:normal; font-weight:700; color:rgb(73, 68, 66);">
  <span style="text-decoration:none; font-style:normal; font-weight:700; color:rgb(73, 68, 66);">
   <span style="text-decoration:none; font-style:normal; font-weight:700; color:rgb(73, 68, 66);">
     Frontend
   </span>
  </span>
 </span>
 </h2>
 <div class="paragraph" style="text-align:left;">
 <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
  <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
   <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
    <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
     <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
      <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
       <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
        <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
          Then, we began to work with LeafLet library in order to locate the user and represent the locations.
         <br/>
        </span>
       </span>
      </span>
     </span>
    </span>
   </span>
  </span>
 </span>
 </div>
 <div>
 <div align="left" class="wcustomhtml" id="735567100404214780" style="width: 100%; overflow-y: hidden;">
  <!-- code formatted by http://manoli.net/csharpformat/ -->
  <style type="text/css">
    .csharpcode, .csharpcode pre {         font-size: small;         color: black;         font-family: Consolas, "Courier New", Courier, Monospace;         background-color: #ffffff;         /*white-space: pre;*/ }  .csharpcode pre { margin: 0em; }  .csharpcode .rem { color: #008000; }  .csharpcode .kwrd { color: #0000ff; }  .csharpcode .str { color: #a31515; }  .csharpcode .op { color: #0000c0; }  .csharpcode .preproc { color: #cc6633; }  .csharpcode .asp { background-color: #ffff00; }  .csharpcode .html { color: #800000; }  .csharpcode .attr { color: #ff0000; }  .csharpcode .alt  {         background-color: #f4f4f4;         width: 100%;         margin: 0em; }  .csharpcode .lnum { color: #606060; }
  </style>
  <div class="csharpcode">
   <pre class="alt"> <span class="lnum">   1: </span>function customMark(lat, lon, message, icon) </pre>
   <pre> <span class="lnum">   2: </span>{ </pre>
   <pre class="alt"> <span class="lnum">   3: </span>   <span class="kwrd">var</span> marker = L.marker([lat, lon], {icon: icon}).addTo(map) </pre>
   <pre> <span class="lnum">   4: </span>   <span class="kwrd">if</span> (message != <span class="kwrd">null</span>) </pre>
   <pre class="alt"> <span class="lnum">   5: </span>    { </pre>
   <pre> <span class="lnum">   6: </span>        marker.bindPopup(message); </pre>
   <pre class="alt"> <span class="lnum">   7: </span>    } </pre>
   <pre> <span class="lnum">   8: </span>   <span class="kwrd">return</span> marker </pre>
   <pre class="alt"> <span class="lnum">   9: </span>} </pre>
   <pre> <span class="lnum">  10: </span> </pre>
   <pre class="alt"> <span class="lnum">  11: </span>function onLocationFound(e) </pre>
   <pre> <span class="lnum">  12: </span>{ </pre>
   <pre class="alt"> <span class="lnum">  13: </span>   <span class="kwrd">var</span> radius = e.accuracy / 2; </pre>
   <pre> <span class="lnum">  14: </span> </pre>
   <pre class="alt"> <span class="lnum">  15: </span>    L.marker(e.latlng).addTo(map) </pre>
   <pre> <span class="lnum">  16: </span>    .bindPopup(<span class="str">"You are within "</span> + radius + <span class="str">" meters from this point"</span>).openPopup(); </pre>
   <pre class="alt"> <span class="lnum">  17: </span> </pre>
   <pre> <span class="lnum">  18: </span>    L.circle(e.latlng, radius).addTo(map); </pre>
   <pre class="alt"> <span class="lnum">  19: </span>} </pre>
   <pre> <span class="lnum">  20: </span> </pre>
   <pre class="alt"> <span class="lnum">  21: </span>function markAirports(airports) </pre>
   <pre> <span class="lnum">  22: </span>{ </pre>
   <pre class="alt"> <span class="lnum">  23: </span>   <span class="kwrd">var</span> airportIcon = L.icon({ </pre>
   <pre> <span class="lnum">  24: </span>    iconUrl: <span class="str">'http://excellencyairportlimousine.com/pics/airport.png'</span>, </pre>
   <pre class="alt"> <span class="lnum">  25: </span>    iconSize: [50, 50], </pre>
   <pre> <span class="lnum">  26: </span>    iconAnchor: [25, 25], </pre>
   <pre class="alt"> <span class="lnum">  27: </span>    popupAnchor: [-3, -76], </pre>
   <pre> <span class="lnum">  28: </span>    </pre>
   <pre class="alt"> <span class="lnum">  29: </span>    }); </pre>
   <pre> <span class="lnum">  30: </span> </pre>
   <pre class="alt"> <span class="lnum">  31: </span>   <span class="kwrd">for</span>(<span class="kwrd">var</span> i = 0; i &lt; airports.length; i++) </pre>
   <pre> <span class="lnum">  32: </span>    { </pre>
   <pre class="alt"> <span class="lnum">  33: </span>       <span class="kwrd">var</span> airport = airports[i]; </pre>
   <pre> <span class="lnum">  34: </span>       <span class="kwrd">var</span> city = airport[<span class="str">"city"</span>]; </pre>
   <pre class="alt"> <span class="lnum">  35: </span>       <span class="kwrd">var</span> name = airport[<span class="str">"name"</span>]; </pre>
   <pre> <span class="lnum">  36: </span>       <span class="kwrd">var</span> lat = airport[<span class="str">"lat"</span>]; </pre>
   <pre class="alt"> <span class="lnum">  37: </span>       <span class="kwrd">var</span> lon = airport[<span class="str">"lon"</span>]; </pre>
   <pre> <span class="lnum">  38: </span>        customMark(lat, lon, name, airportIcon);    </pre>
   <pre class="alt"> <span class="lnum">  39: </span>    } </pre>
   <pre> <span class="lnum">  40: </span>} </pre>
   <pre class="alt"> <span class="lnum">  41: </span> </pre>
   <pre> <span class="lnum">  42: </span>function onLocationClosest(e) </pre>
   <pre class="alt"> <span class="lnum">  43: </span>{ </pre>
   <pre> <span class="lnum">  44: </span>   <span class="kwrd">var</span> handleResponse = function (status, response) { </pre>
   <pre class="alt"> <span class="lnum">  45: </span>        alert(response) </pre>
   <pre> <span class="lnum">  46: </span>    } </pre>
   <pre class="alt"> <span class="lnum">  47: </span> </pre>
   <pre> <span class="lnum">  48: </span>   <span class="kwrd">var</span> handleStateChange = function(xmlhttp) </pre>
   <pre class="alt"> <span class="lnum">  49: </span>    { </pre>
   <pre> <span class="lnum">  50: </span>       <span class="kwrd">return</span>  (xmlhttp.readyState == 4) ? handleResponse(xmlhttp.status, xmlhttp.response) : <span class="kwrd">null</span>; </pre>
   <pre class="alt"> <span class="lnum">  51: </span>    } </pre>
   <pre> <span class="lnum">  52: </span> </pre>
   <pre class="alt"> <span class="lnum">  53: </span>   <span class="kwrd">var</span> xmlhttp = <span class="kwrd">new</span> XMLHttpRequest(); </pre>
   <pre> <span class="lnum">  54: </span>    xmlhttp.open(<span class="str">"POST"</span>, <span class="str">"/"</span>, <span class="kwrd">false</span>); </pre>
   <pre class="alt"> <span class="lnum">  55: </span>    xmlhttp.setRequestHeader(<span class="str">'Content-Type'</span>, <span class="str">'application/json'</span>); </pre>
   <pre> <span class="lnum">  56: </span>    xmlhttp.onreadystatechange = handleStateChange(xmlhttp); </pre>
   <pre class="alt"> <span class="lnum">  57: </span> </pre>
   <pre> <span class="lnum">  58: </span>    seen = []; </pre>
   <pre class="alt"> <span class="lnum">  59: </span>    xmlhttp.send(JSON.stringify(e,function(key, val) </pre>
   <pre> <span class="lnum">  60: </span>    { </pre>
   <pre class="alt"> <span class="lnum">  61: </span>       <span class="kwrd">if</span> (val != <span class="kwrd">null</span> &amp;&amp; <span class="kwrd">typeof</span> val == <span class="str">"object"</span>) { </pre>
   <pre> <span class="lnum">  62: </span>           <span class="kwrd">if</span> (seen.indexOf(val) &gt;= 0) </pre>
   <pre class="alt"> <span class="lnum">  63: </span>               <span class="kwrd">return</span> </pre>
   <pre> <span class="lnum">  64: </span>            seen.push(val) </pre>
   <pre class="alt"> <span class="lnum">  65: </span>        } </pre>
   <pre> <span class="lnum">  66: </span>       <span class="kwrd">return</span> val </pre>
   <pre class="alt"> <span class="lnum">  67: </span>    })); </pre>
   <pre> <span class="lnum">  68: </span> </pre>
   <pre class="alt"> <span class="lnum">  69: </span>   <span class="kwrd">var</span> response = JSON.parse(xmlhttp.response); </pre>
   <pre> <span class="lnum">  70: </span>       markAirportsAndYourPosition(response, e); </pre>
   <pre class="alt"> <span class="lnum">  71: </span>} </pre>
   <pre> <span class="lnum">  72: </span> </pre>
   <pre class="alt"> <span class="lnum">  73: </span>function closestAirports() </pre>
   <pre> <span class="lnum">  74: </span>{ </pre>
   <pre class="alt"> <span class="lnum">  75: </span>    map.on(<span class="str">'locationfound'</span>, onLocationClosest); </pre>
   <pre> <span class="lnum">  76: </span>    map.locate(); </pre>
   <pre class="alt"> <span class="lnum">  77: </span>} </pre>
  </div>
 </div>
 </div>
 <div class="paragraph" style="text-align:left;">
 <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
  <br/>
 </span>
 </div>
 <h2 class="wsite-content-title" style="text-align:left;">
 <span style="text-decoration:none; font-style:normal; font-weight:700; color:rgb(73, 68, 66);">
   Conclusion
 </span>
 </h2>
 <div class="paragraph" style="text-align:left;">
 <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
  <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
   <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
    <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
     <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
      <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
       <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
        <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
         <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
          <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
           <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
            <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
             <span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(121, 117, 112);">
               I have really enjoyed this project. The Flask+MongoDB+LeafLet mixture has been a very good option. I expect to use ArangoDB in the future.
              <br>
               <br>
                 I would like to thank Openflights again. Without their data, this PoC would not have been possible.
                <br>
                 <br>
                   The app should be running in
                  <a href="http://airports-dollbox.rhcloud.com/" target="_blank" title="">
                    http://airports-dollbox.rhcloud.com/
                  </a>
                   .
                  <br>
                   <br>
                     This project is in
                    <a href="https://github.com/mendrugory/Airports" target="_blank" title="">
                      github
                    </a>
                     .
                    <br/>
                   </br>
                  </br>
                 </br>
                </br>
               </br>
              </br>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </span>
   </span>
  </span>
 </span>
 </div>
</div>
